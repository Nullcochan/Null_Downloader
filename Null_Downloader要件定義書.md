個人用動画ダウンローダー開発 要件定義書
1. 概要
1.1. プロジェクトの目的
本プロジェクトは、個人が技術学習を目的として、動画ダウンロードおよび形式変換を行うWebアプリケーションを開発することを目的とする。作成されたアプリケーションは、著作権法で認められた私的利用の範囲内、かつ、自身の著作物や再利用が許可されたコンテンツの加工を目的として、閉じたネットワーク環境（ローカル環境など）でのみ使用されることを前提とする。
1.2. プロジェクトの背景
Web技術（フロントエンド、サーバーサイド）と外部コマンド（yt-dlp, FFmpeg）を連携させるアプリケーション開発を通じて、実践的なスキルを習得する。参考サイト「y2down.cc」のような既存のサービスを参考にしつつ、よりシンプルで学習に適した機能を実装する。
1.3. 前提条件
著作権の遵守: 本アプリケーションの利用は、著作権法を遵守する範囲内に限定される。第三者が著作権を有するコンテンツを、権利者の許可なくダウンロード、配布、公開する行為は行わない。
利用規約の尊重: YouTubeなどの動画プラットフォームが定める利用規約を尊重し、規約に反する利用は行わない。本ツールは自己責任において利用するものとする。
非公開: 開発するアプリケーションはインターネット上に公開せず、個人のローカル環境やプライベートなネットワーク内でのみ利用する。
2. システムの概要
2.1. システム構成
本システムは、ユーザーが操作する「フロントエンド」、動画のダウンロードと変換処理を行う「サーバーサイド」、およびサーバーサイドから呼び出される「外部ツール」で構成される。
フロントエンド:
実装技術: HTML, JavaScript
役割: ユーザーからの動画URL入力を受け付け、サーバーサイドに処理を要求し、結果（ダウンロードファイルやステータス）を表示する。
サーバーサイド:
実装技術: Node.js, Expressフレームワーク
役割: フロントエンドからの要求を受け、外部ツールを制御して動画のダウンロードとMP4への変換を実行する。変換したファイルをフロントエンドに提供する。
外部ツール:
yt-dlp: 指定されたURLから動画ファイルをダウンロードする。
FFmpeg: ダウンロードした動画ファイルをMP4形式に変換（トランスコード）する。
3. 機能要件
ユーザーが動画のURLを入力し、MP4形式の動画ファイルを取得するための一連の機能を定義する。
要件ID	機能名	概要	備考
F-01	動画URL入力機能	ユーザーが対象の動画URLを入力できるテキストボックスを画面に表示する。	
F-02	変換実行機能	ユーザーがURL入力後にクリックする「変換開始」ボタンを画面に表示する。ボタンクリックにより、入力されたURLをサーバーに送信する。	
F-03	動画ダウンロード機能	サーバーサイドでyt-dlpを使い、指定されたURLから最高画質・音質の動画をダウンロードする。	一時的なファイルとしてサーバー上に保存する。
F-04	MP4形式への変換機能	サーバーサイドでFFmpegを使い、ダウンロードした動画ファイルをH.264 (映像) + AAC (音声) のMP4コンテナに変換する。	品質やエンコード速度のパラメータは、学習目的なのでデフォルト値とする。
F-05	ファイル提供機能	変換が完了したMP4ファイルを、ユーザーがブラウザ経由でダウンロードできるようにする。	処理完了後に自動的にダウンロードが開始される。
F-06	処理状況表示機能	ユーザーに対して、現在の処理状況（「変換中...」「完了！」「エラー」など）を簡易的にテキストで表示する。	
F-07	一時ファイル削除機能	ユーザーへのファイル提供が完了、またはエラーが発生した場合、サーバー上に保存された一時ファイル（ダウンロード元ファイル、変換後MP4ファイル）を自動的に削除する。	サーバーのストレージを圧迫しないようにするため。
4. 非機能要件
項目	要件
ユーザビリティ	・URLを貼り付けてボタンを1回押すだけの、直感的でシンプルな操作で利用できること。<br>・専門的な知識がなくても使えるインターフェースであること。
セキュリティ	・システムはローカルネットワーク内での利用を前提とし、外部（インターネット）に公開しないこと。<br>・（推奨）Basic認証などの簡易なアクセス制限を導入し、意図しない第三者による利用を防ぐこと。
性能	・一般的な長さ（10分程度）の動画であれば、ユーザーがストレスを感じない現実的な時間（数分以内）で処理が完了すること。<br>※サーバーマシンのスペックやネットワーク速度に依存する。
動作環境	・サーバーサイド: Node.js (LTS版)、yt-dlp、FFmpegがインストール済みの環境。<br>・クライアントサイド: 最新版のGoogle Chrome, Mozilla Firefox, Microsoft Edge, Safariなどのモダンブラウザ。
保守性	・ご提示いただいたサンプルコードのように、機能ごとに処理がまとまっており、後から処理内容の変更や拡張がしやすい構造であること。
5. 将来的な拡張案
初期開発のスコープ外とするが、今後の学習テーマとして以下のような機能拡張が考えられる。
解像度・フォーマット選択機能: 参考サイトのように、複数の画質（1080p, 720pなど）や形式（MP4, WebM）からユーザーが選択できるようにする。
音声のみの抽出機能: 動画から音声のみを抽出し、MP3形式でダウンロードする機能を追加する。
進捗表示の高度化: パーセンテージ表示やプログレスバーにより、詳細な進捗状況をユーザーに提示する。
Dockerコンテナ化: Node.jsや外部ツールの環境構築を容易にするため、アプリケーション全体をDockerコンテナで動作させる。